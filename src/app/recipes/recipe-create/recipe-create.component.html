<div class="main-short">
  <div class="wrapper">
    <h1 class="title">Add a recipe</h1>
    <form [formGroup]="recipeForm">
      <!-- Title required-->
      <label>
        Title (required):

        <input type="text" id="title" formControlName="title" />
      </label>

      <div *ngIf="recipeForm.get('title')?.touched">
        <div
          class="errors"
          *ngIf="recipeForm.get('title')?.errors?.['required']"
        >
          Please fill in the title!
        </div>
      </div>
      <!-- Title -->

      <!-- Subtitle required-->
      <label>
        Subtitle (required):
        <input type="text" id="subtitle" formControlName="subtitle" />
      </label>

      <div *ngIf="recipeForm.get('subtitle')?.touched">
        <div
          class="errors"
          *ngIf="recipeForm.get('subtitle')?.errors?.['required']"
        >
          Please fill in a subtitle!
        </div>
      </div>
      <!-- Subtitle -->

      <!-- Description required-->

      <div>
        <label for="description">Method of preparation (required):</label>
        <textarea
          name="text"
          id="description"
          formControlName="description"
          cols="30"
          rows="5"
        ></textarea>
      </div>
      <div *ngIf="recipeForm.get('description')?.touched">
        <div
          class="errors"
          *ngIf="recipeForm.get('description')?.errors?.['required']"
        >
          Please fill in the method of preparation!
        </div>
      </div>
      <!-- Description -->

      <!-- Summary -->
      <div>
        <label for="summary">Summary:</label>
        <p class="hint">Recipe summary</p>
        <input type="text" id="summary" formControlName="summary" />
      </div>
      <!-- Summary -->

      <div>
        <!-- Image Upload -->
        <br />
        <app-image-upload (imageUploaded)="addImageToForm($event)" />

        <!-- Image Upload -->

        <!-- Image -->
        <div formArrayName="image_recipe">
          <div
            *ngFor="let image of image_recipe.controls; let i = index"
            [formGroupName]="i"
          >
            <p class="hint">Added image</p>
            <input
              type="text"
              id="image_recipe"
              formControlName="image_recipe"
            />

            <!-- Image preview -->
            <img
              *ngIf="image_recipe.controls[i].get('image_recipe')?.value"
              [src]="image_recipe.controls[i].get('image_recipe')?.value"
              alt="Image Preview"
              class="image-preview"
            />
            <br />
            <button
              class="removeIngredient"
              type="button"
              (click)="removeImage(i)"
            >
              <i class="fa-solid fa-trash fa-shake"></i>&nbsp; Remove added
              image
            </button>
            <br />
          </div>
        </div>
        <!-- Image -->

        <!-- Video -->
        <div formArrayName="video_recipe">
          <div
            *ngFor="let video of video_recipe.controls; let i = index"
            [formGroupName]="i"
          >
            <p class="hint">Paste the video link here</p>
            <input
              type="text"
              id="video_recipe"
              formControlName="video_recipe"
            />
            <button
              class="removeIngredient"
              type="button"
              (click)="removeVideo(i)"
            >
              <i class="fa-solid fa-trash fa-shake"></i>&nbsp; Remove the video
              link
            </button>
          </div>
          <button class="button-img" type="button" (click)="addVideo()">
            <i class="fa-solid fa-plus fa-beat-fade"></i>
            Add a link to a recipe
          </button>
        </div>
        <!-- Video -->
      </div>

      <div class="ingredients" formArrayName="ingredients">
        <div
          *ngFor="let ingredient of ingredients.controls; let i = index"
          [formGroupName]="i"
        >
          <div class="ingredient">
            <!-- Ingredient -->
            <div class="divider">
              <hr />
              <p>&nbsp;&nbsp;Ingredient&nbsp;&nbsp;</p>
              <hr />
            </div>

            <!-- Name required-->

            <label for="name">Name (required):</label>
            <input type="text" id="name" formControlName="name" />

            <div *ngIf="recipeForm.get('ingredients.' + i + '.name')?.touched">
              <div
                class="errors"
                *ngIf="recipeForm.get('ingredients.' + i + '.name')?.errors?.['required']"
              >
                Please enter an ingredient name!
              </div>
            </div>

            <!-- Amount required-->

            <label for="amount">Quantity (required):</label>
            <input type="number" id="amount" formControlName="amount" />

            <div
              *ngIf="recipeForm.get('ingredients.' + i + '.amount')?.touched"
            >
              <div
                class="errors"
                *ngIf="recipeForm.get('ingredients.' + i + '.amount')?.errors?.['required']"
              >
                Please fill in the quantity of the ingredient!
              </div>
            </div>

            <!-- Unit required-->

            <label for="unit">Unit of measurement (required):</label>
            <p class="hint">In which we measure the ingredient</p>
            <!--            <input type="text" id="unit" formControlName="unit"/>-->
            <select id="ingredient_unit" formControlName="unit">
              <option value="ts.">Tea spoon</option>
              <option value="tbs.">Tablespoon</option>
              <option value="tc.">Tea cup</option>
              <option value="cc.">Coffee cup</option>
              <option value="gr.">Gram</option>
              <option value="kg.">Kilogram</option>
              <option value="ml.">Milliliter</option>
              <option value="l.">Liter</option>
              <option value="pieces">Pieces</option>

            </select>

            <div *ngIf="recipeForm.get('ingredients.' + i + '.unit')?.touched">
              <div
                class="errors"
                *ngIf="recipeForm.get('ingredients.' + i + '.unit')?.errors?.['required']"
              >
                Please select a unit of measurement!
              </div>
            </div>


            <!-- I can hide the order index - when the user needs it, he can press the "Show order index" button -->
            <!-- Order Index -->

            <label for="order_index">Order index:</label>
            <p class="hint">
              The order in which the ingredients appear in the recipe
            </p>
            <input
              type="number"
              id="ingredient_order_index"
              formControlName="order_index"
            />

            <!-- Add a button to remove the ingredient -->
            <button
              class="removeIngredient"
              type="button"
              (click)="removeIngredient(i)"
            >
              <i class="fa-solid fa-trash fa-shake"></i>&nbsp;Remove the
              ingredient
            </button>
          </div>
        </div>
      </div>
      <br />

      <hr>
      <br>
      <button type="button" class="button-img" (click)="addIngredient()">
        <i class="fa-solid fa-plus fa-beat-fade"></i>
        Add one more ingredient
      </button>
      <br />
      <button
        type="button"
        style="width: 100%"
        class="button"
        (click)="onSubmit()"
      >
        Add a recipe
      </button>
      <br />
      <!-- <a class="backBtn" href="javascript:history.back()"
        ><i class="fa-solid fa-backward fa-beat-fade"></i>&nbsp;&nbsp;Go back</a
      > -->

      <hr />
      Go Back
      <a class="back-button" href="javascript:history.back()">
        <div class="button-box">
          <span class="button-elem">
            <svg viewBox="0 0 46 40" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z"
              ></path>
            </svg>
          </span>
          <span class="button-elem">
            <svg viewBox="0 0 46 40">
              <path
                d="M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z"
              ></path>
            </svg>
          </span>
        </div>
      </a>
    </form>
  </div>
</div>

<!-- <label>
  <span class="hint">Description (required):</span>
  <editor class="tiny" formControlName="description" [init]="editorConfig">
  </editor>
</label> -->
